# Walrus Sites Configuration for WalTodo Frontend
# Optimized for performance and security
# Generated by deploy-walrus-site.sh

waltodo-app:
  source: "/Users/angel/Documents/Projects/walrus_todo/waltodo-frontend/walrus-site-waltodo/out"
  network: "testnet"
  
  # Performance-optimized headers
  headers:
    # Static assets with long-term caching
    "/_next/static/*":
      - "Cache-Control: public, max-age=31536000, immutable"
      - "X-Content-Type-Options: nosniff"
    
    # Images and media with moderate caching
    "/images/*":
      - "Cache-Control: public, max-age=86400"
      - "X-Content-Type-Options: nosniff"
      - "Accept-Ranges: bytes"
    
    "*.{jpg,jpeg,png,gif,webp,avif,svg,ico}":
      - "Cache-Control: public, max-age=86400"
      - "X-Content-Type-Options: nosniff"
      - "Accept-Ranges: bytes"
    
    # JavaScript and CSS with versioned caching
    "*.{js,css,mjs}":
      - "Cache-Control: public, max-age=86400"
      - "X-Content-Type-Options: nosniff"
    
    # Fonts with long-term caching
    "*.{woff,woff2,ttf,eot}":
      - "Cache-Control: public, max-age=31536000"
      - "X-Content-Type-Options: nosniff"
      - "Access-Control-Allow-Origin: *"
    
    # JSON config files with short-term caching
    "/config/*.json":
      - "Cache-Control: public, max-age=300"
      - "Content-Type: application/json"
      - "X-Content-Type-Options: nosniff"
    
    # HTML pages with security headers
    "*.html":
      - "Cache-Control: public, max-age=300"
      - "X-Content-Type-Options: nosniff"
      - "X-Frame-Options: DENY"
      - "X-XSS-Protection: 1; mode=block"
      - "Referrer-Policy: strict-origin-when-cross-origin"
      - "Content-Security-Policy: default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https:; style-src 'self' 'unsafe-inline' https:; img-src 'self' data: https:; connect-src 'self' https: wss:; font-src 'self' https: data:; object-src 'none'; media-src 'self' https:; worker-src 'self' blob:; child-src 'self' https:; form-action 'self'; upgrade-insecure-requests"
    
    # Default fallback for all other files
    "/*":
      - "Cache-Control: public, max-age=300"
      - "X-Content-Type-Options: nosniff"
      - "X-Frame-Options: DENY"
      - "X-XSS-Protection: 1; mode=block"
      - "Referrer-Policy: strict-origin-when-cross-origin"
      - "Permissions-Policy: camera=(), microphone=(), geolocation=(), interest-cohort=()"
  
  # URL redirects and rewrites
  redirects:
    # API routes to backend
    - from: "/api/*"
      to: "https://api.waltodo.com/api/*"
      status: 307
    
    # Legacy URL redirects
    - from: "/app/*"
      to: "/*"
      status: 301
    
    # Wallet connection redirects
    - from: "/wallet"
      to: "/?wallet=connect"
      status: 302
  
  # Custom error pages
  error_pages:
    404: "/404.html"
    500: "/404.html"
  
  # Performance optimizations
  performance:
    # Enable compression for text-based assets
    compression:
      enabled: true
      types: ["text/html", "text/css", "text/javascript", "application/javascript", "application/json", "text/xml", "application/xml", "image/svg+xml"]
      level: 6
    
    # Enable HTTP/2 server push for critical resources
    push:
      - "/_next/static/css/app.css"
      - "/_next/static/js/app.js"
    
    # Preload critical resources
    preload:
      - href: "/favicon.ico"
        as: "image"
      - href: "/_next/static/css/app.css"
        as: "style"
    
    # Enable service worker caching
    service_worker:
      enabled: true
      path: "/sw.js"
      scope: "/"

# Production configuration
waltodo-app-prod:
  source: "/Users/angel/Documents/Projects/walrus_todo/waltodo-frontend/walrus-site-waltodo/out"
  network: "mainnet"
  
  # Enhanced security headers for production
  headers:
    # Static assets with long-term caching
    "/_next/static/*":
      - "Cache-Control: public, max-age=31536000, immutable"
      - "X-Content-Type-Options: nosniff"
      - "Strict-Transport-Security: max-age=31536000; includeSubDomains; preload"
    
    # Images and media with moderate caching
    "/images/*":
      - "Cache-Control: public, max-age=604800"
      - "X-Content-Type-Options: nosniff"
      - "Accept-Ranges: bytes"
    
    "*.{jpg,jpeg,png,gif,webp,avif,svg,ico}":
      - "Cache-Control: public, max-age=604800"
      - "X-Content-Type-Options: nosniff"
      - "Accept-Ranges: bytes"
    
    # JavaScript and CSS with versioned caching
    "*.{js,css,mjs}":
      - "Cache-Control: public, max-age=604800"
      - "X-Content-Type-Options: nosniff"
    
    # Fonts with long-term caching
    "*.{woff,woff2,ttf,eot}":
      - "Cache-Control: public, max-age=31536000"
      - "X-Content-Type-Options: nosniff"
      - "Access-Control-Allow-Origin: https://waltodo.com"
    
    # JSON config files with shorter caching for production
    "/config/*.json":
      - "Cache-Control: public, max-age=600"
      - "Content-Type: application/json"
      - "X-Content-Type-Options: nosniff"
    
    # HTML pages with enhanced security
    "*.html":
      - "Cache-Control: public, max-age=600"
      - "X-Content-Type-Options: nosniff"
      - "X-Frame-Options: DENY"
      - "X-XSS-Protection: 1; mode=block"
      - "Referrer-Policy: strict-origin-when-cross-origin"
      - "Content-Security-Policy: default-src 'self'; script-src 'self' 'unsafe-inline' https:; style-src 'self' 'unsafe-inline' https:; img-src 'self' data: https:; connect-src 'self' https: wss:; font-src 'self' https: data:; object-src 'none'; media-src 'self' https:; worker-src 'self' blob:; child-src 'self' https:; form-action 'self'; upgrade-insecure-requests"
      - "Strict-Transport-Security: max-age=31536000; includeSubDomains; preload"
    
    # Default fallback with enhanced security
    "/*":
      - "Cache-Control: public, max-age=600"
      - "X-Content-Type-Options: nosniff"
      - "X-Frame-Options: DENY"
      - "X-XSS-Protection: 1; mode=block"
      - "Referrer-Policy: strict-origin-when-cross-origin"
      - "Permissions-Policy: camera=(), microphone=(), geolocation=(), interest-cohort=()"
      - "Strict-Transport-Security: max-age=31536000; includeSubDomains; preload"
  
  # Production redirects
  redirects:
    # API routes to production backend
    - from: "/api/*"
      to: "https://api.waltodo.com/api/*"
      status: 307
  
  # Custom error pages
  error_pages:
    404: "/404.html"
    500: "/404.html"
    503: "/404.html"