"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2090],{82090:function(e,t,a){a.d(t,{Z:function(){return p}});var s=a(29754),r=a(22585),o=a(6229),l=a(98436),c=a(19132),i=a(59295),n=a(82265),d=a(62196),m=a(18125);function x(e){let{todoId:t,imageUrl:a,imageUrls:o,showPerformanceMetrics:l=!1}=e,c=e=>e.startsWith("0x")||e.includes("walrus")?"".concat("https://aggregator.walrus-testnet.walrus.space","/v1/").concat(e):e;if(r.useEffect(()=>{if(!l)return;let e=setInterval(()=>{(0,m.getImagePerformanceMetrics)().size},5e3);return()=>clearInterval(e)},[l]),a)return(0,s.jsxs)("div",{className:"todo-image-container",children:[(0,s.jsx)(d.OptimizedImage,{src:c(a),alt:"Image for todo ".concat(t),width:400,height:300,className:"rounded-lg shadow-md",priority:"high",placeholder:"blur",onLoad:()=>console.log("Image loaded for todo ".concat(t)),onError:()=>console.error("Failed to load image for todo ".concat(t))}),l&&(0,s.jsx)(u,{})]});if(o&&o.length>0){let e=o.map((e,a)=>({src:c(e),alt:"Image ".concat(a+1," for todo ").concat(t),id:"".concat(t,"-").concat(a)}));return(0,s.jsxs)("div",{className:"todo-gallery-container",children:[(0,s.jsx)(d.OptimizedImageGallery,{images:e,columns:3}),l&&(0,s.jsx)(u,{})]})}return null}function u(){let[e,t]=r.useState(new Map);return(r.useEffect(()=>{let e=()=>{t(new Map((0,m.getImagePerformanceMetrics)()))};e();let a=setInterval(e,1e3);return()=>clearInterval(a)},[]),0===e.size)?null:(0,s.jsxs)("div",{className:"mt-4 p-4 bg-gray-100 dark:bg-gray-800 rounded-lg text-sm",children:[(0,s.jsx)("h4",{className:"font-semibold mb-2",children:"Performance Metrics"}),(0,s.jsx)("div",{className:"space-y-1",children:Array.from(e.entries()).map(e=>{let[t,a]=e;return(0,s.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,s.jsx)("span",{className:"truncate max-w-xs",children:t.split("/").pop()}),(0,s.jsxs)("span",{children:[a.loadTime.toFixed(0),"ms | ",(a.size/1024).toFixed(1),"KB |",a.cached?" (cached)":""," ",a.format]})]},t)})}),(0,s.jsx)("button",{onClick:()=>{(0,m.clearImageCaches)(),window.location.reload()},className:"mt-2 text-xs text-blue-600 hover:text-blue-800",children:"Clear Caches"})]})}function h(){return(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,s.jsx)("div",{className:"w-12 h-12 rounded-full border-4 border-gray-200 border-t-blue-600 animate-spin"}),(0,s.jsx)("div",{className:"mt-4 text-center",children:(0,s.jsx)("p",{className:"text-sm text-gray-500 animate-pulse",children:"Initializing todo list..."})})]})}var p=(0,r.memo)(function(e){let{listName:t}=e,[a,d]=(0,r.useState)([]),[m,u]=(0,r.useState)(!0),[p,f]=(0,r.useState)([]),[g,b]=(0,r.useState)(!1),[j,k]=(0,r.useState)(!1),[N,v]=(0,r.useState)(!1),{address:w,connected:y,signAndExecuteTransaction:I}=(0,o.tN)()||{},{isInitialized:C,isInitializing:S,error:D}=(0,i.n)("testnet"),E=(0,r.useMemo)(()=>[...a,...p].reduce((e,t)=>{let a=e.find(e=>e.objectId&&e.objectId===t.objectId);if(a){if(t.blockchainStored&&!a.blockchainStored){let s=e.indexOf(a);e[s]=t}}else e.push(t);return e},[]),[a,p]),F=(0,r.useMemo)(()=>E,[E]);(0,r.useEffect)(()=>{k(!0)},[]),(0,r.useEffect)(()=>{j&&(C||!y)&&v(!0)},[j,C,y]),(0,r.useEffect)(()=>{let e=!0;return(async()=>{if(j&&N){if(!y||!w){e&&f([]);return}if(C){e&&b(!0);try{let t=await (0,c.xe)(w);e&&f(t)}catch(t){e&&(f([]),n.default.error("Failed to load blockchain todos. Using local storage only.",{duration:4e3,icon:"⚠️"}))}finally{e&&b(!1)}}}})(),()=>{e=!1}},[y,w,C,j,N]),(0,r.useEffect)(()=>{let e=!0;return(async()=>{e&&u(!0);try{let a=(0,l.LC)(t,w||void 0);e&&d(a)}catch(t){e&&(d([]),n.default.error("Failed to load todos from local storage",{duration:4e3}))}finally{e&&u(!1)}})(),()=>{e=!1}},[t,w]);let z=(0,r.useCallback)(async()=>{if(j&&N&&y&&w&&C)try{let e=await (0,c.xe)(w);f(e)}catch(e){n.default.error("Failed to refresh blockchain todos",{duration:3e3})}},[y,w,C,j,N]),L=(0,r.useCallback)(async e=>{if(!j||!N)return;let a=F.find(t=>t.id===e);if(a){d(F.map(t=>t.id===e?{...t,completed:!t.completed,completedAt:t.completed?void 0:new Date().toISOString()}:t));try{if(a.blockchainStored&&a.objectId&&I&&C){let e=await (0,c.completeTodoOnBlockchain)(a.objectId,I,w||"");if(e.success)n.default.success("Todo updated on blockchain!",{duration:3e3,icon:"\uD83C\uDF89"}),await z();else throw Error(e.error||"Failed to complete todo on blockchain")}else{let e={...a,completed:!a.completed,completedAt:a.completed?void 0:new Date().toISOString()};if((0,l.CU)(t,e,w||void 0))n.default.success("Todo updated!",{duration:2e3});else{n.default.error("Failed to update todo",{duration:3e3});let e=(0,l.LC)(t,w||void 0);d(e)}}}catch(a){let e=a instanceof Error?a.message:"Failed to update todo";n.default.error(e,{duration:5e3}),d((0,l.LC)(t,w||void 0)),y&&w&&await z()}}},[F,I,w,z,t,y,C,j,N]),M=(0,r.useCallback)(async e=>{if(j&&N&&y&&w&&I&&C)try{(0,n.default)("Feature coming soon: Store existing todo as NFT on Sui blockchain",{duration:4e3,icon:"\uD83D\uDEA7"})}catch(e){n.default.error("Failed to store todo on blockchain",{duration:4e3})}},[y,w,I,C,j,N]),T=(0,r.useCallback)(async e=>{if(j&&N&&confirm('Are you sure you want to delete "'.concat(e.title,'"?')))try{if(e.blockchainStored&&e.objectId&&I&&C){let t=await (0,c.deleteTodoOnBlockchain)(e.objectId,I,w||"");if(t.success)n.default.success("Todo deleted from blockchain!",{duration:3e3,icon:"\uD83D\uDDD1️"}),await z();else throw Error(t.error||"Failed to delete todo from blockchain")}else{let t=a.filter(t=>t.id!==e.id);d(t),n.default.success("Todo deleted!",{duration:2e3})}}catch(t){let e=t instanceof Error?t.message:"Failed to delete todo";n.default.error(e,{duration:5e3})}},[I,w,z,a,C,j,N]);return j?m||y&&S?(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,s.jsx)("div",{className:"w-12 h-12 rounded-full border-4 border-ocean-light border-t-ocean-deep animate-spin"}),(0,s.jsxs)("div",{className:"mt-4 text-center",children:[!j&&(0,s.jsx)("p",{className:"text-sm text-ocean-medium animate-pulse",children:"Loading component..."}),j&&m&&(0,s.jsx)("p",{className:"text-sm text-ocean-medium animate-pulse",children:"Loading todos..."}),j&&y&&S&&(0,s.jsx)("p",{className:"text-sm text-ocean-medium animate-pulse",children:"Initializing blockchain connection..."})]})]}):j&&y&&D?(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsxs)("div",{className:"text-red-500 mb-4",children:[(0,s.jsx)("p",{className:"font-medium",children:"Blockchain Connection Error"}),(0,s.jsx)("p",{className:"text-sm",children:D})]}),(0,s.jsx)("p",{className:"text-sm text-ocean-medium/70 dark:text-ocean-light/70",children:"Local todos will still work. Try refreshing to reconnect to the blockchain."})]}):0===F.length?(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("p",{className:"text-ocean-medium dark:text-ocean-light mb-4",children:"No todos in this list yet."}),(0,s.jsx)("p",{className:"text-sm text-ocean-medium/70 dark:text-ocean-light/70",children:"Create your first todo using the form above!"}),y&&(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),(0,s.jsx)("span",{className:"text-xs text-ocean-medium/70",children:"Blockchain Connected"})]}),(0,s.jsx)("p",{className:"text-xs text-ocean-medium/50 dark:text-ocean-light/50 mt-2",children:"Blockchain integration active"}),g&&(0,s.jsx)("p",{className:"text-xs text-blue-600 dark:text-blue-400 mt-1 animate-pulse",children:"Loading blockchain todos..."})]})]}):(0,s.jsxs)("div",{className:"space-y-4",children:[y&&(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4 p-3 bg-white/30 dark:bg-ocean-deep/30 rounded-lg border border-ocean-light/20",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),(0,s.jsx)("span",{className:"text-sm text-ocean-medium dark:text-ocean-light",children:"Blockchain active"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("div",{className:"w-2 h-2 rounded-full bg-blue-500"}),(0,s.jsx)("span",{className:"text-sm text-blue-600",children:"Blockchain-first mode"})]})]}),(0,s.jsxs)("div",{className:"text-xs text-ocean-medium/70 dark:text-ocean-light/70",children:[F.length," todos"]})]}),F.map(e=>{var t;return(0,s.jsxs)("div",{"data-testid":"todo-item",className:"p-4 rounded-lg transition-all ".concat(e.completed?"bg-green-50/50 dark:bg-green-900/30 border border-green-200 dark:border-green-800/50":"bg-white/50 dark:bg-ocean-deep/30 border border-ocean-light/20"),children:[(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)("button",{onClick:()=>L(e.id),"data-testid":"todo-checkbox",className:"mt-1 w-5 h-5 rounded-full flex-shrink-0 ".concat(e.completed?"bg-green-500 text-white flex items-center justify-center":"border-2 border-ocean-medium"),children:e.completed&&(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"w-3 h-3",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),(0,s.jsxs)("div",{className:"flex-grow",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsx)("h3",{"data-testid":"todo-title",className:"font-medium ".concat(e.completed?"line-through text-ocean-medium/70 dark:text-ocean-light/70 completed":"text-ocean-deep dark:text-ocean-foam"),children:e.title}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[e.blockchainStored&&(0,s.jsxs)("span",{className:"flex items-center text-xs bg-dream-purple/20 text-dream-purple px-2 py-0.5 rounded-full",children:[(0,s.jsx)("span",{className:"w-1.5 h-1.5 bg-dream-purple rounded-full mr-1"}),"NFT"]}),e.objectId&&(0,s.jsx)("a",{href:"https://suiexplorer.com/object/".concat(e.objectId,"?network=testnet"),target:"_blank",rel:"noopener noreferrer",className:"text-xs text-ocean-medium hover:text-ocean-deep dark:text-ocean-light dark:hover:text-ocean-foam transition-colors",title:"View on Sui Explorer",children:"\uD83D\uDD0D"}),(0,s.jsx)("span",{className:"text-xs px-2 py-0.5 rounded-full ".concat("high"===e.priority?"bg-red-100 text-red-600 dark:bg-red-900/30 dark:text-red-300":"medium"===e.priority?"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-300":"bg-blue-100 text-blue-600 dark:bg-blue-900/30 dark:text-blue-300"),children:e.priority})]})]}),e.description&&(0,s.jsx)("p",{className:"mt-1 text-sm text-ocean-medium dark:text-ocean-light/80",children:e.description}),e.imageUrl&&(0,s.jsx)("div",{className:"mt-3",children:(0,s.jsx)(x,{todoId:e.id,imageUrl:e.imageUrl,showPerformanceMetrics:!1})}),(0,s.jsxs)("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[e.tags&&e.tags.map(e=>(0,s.jsxs)("span",{className:"text-xs bg-ocean-light/30 dark:bg-ocean-medium/30 text-ocean-deep dark:text-ocean-foam px-2 py-0.5 rounded-full",children:["#",e]},e)),e.dueDate&&(0,s.jsxs)("span",{className:"text-xs text-ocean-medium dark:text-ocean-light flex items-center",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Due: ",e.dueDate]}),e.blockchainStored&&(0,s.jsx)("span",{className:"text-xs text-purple-600 dark:text-purple-400 flex items-center",children:"⛓️ On-chain todo"})]})]})]}),(0,s.jsxs)("div",{className:"mt-3 pt-3 border-t border-ocean-light/20 dark:border-ocean-medium/20 flex justify-end gap-2",children:[(0,s.jsx)("button",{className:"text-xs text-ocean-medium hover:text-ocean-deep dark:text-ocean-light dark:hover:text-ocean-foam transition-colors",children:"Edit"}),!e.blockchainStored&&y&&(0,s.jsx)("button",{onClick:()=>M(e),className:"text-xs text-purple-600 hover:text-purple-800 dark:text-purple-400 dark:hover:text-purple-300 transition-colors",children:"Store as NFT"}),(0,s.jsx)("button",{onClick:()=>T(e),className:"text-xs text-red-500 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 transition-colors",children:"Delete"})]})]},null!==(t=e.objectId)&&void 0!==t?t:e.id)})]}):(0,s.jsx)(h,{})})}}]);