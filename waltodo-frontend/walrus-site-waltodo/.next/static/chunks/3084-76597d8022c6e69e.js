"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3084],{73084:function(e,r,t){t.d(r,{S:function(){return m}});var o,s,n=t(29754),l=t(22585),a=t(82265),i=t(27680);function c(e){let r=e.message.toLowerCase();return r.includes("network")||r.includes("fetch")||r.includes("timeout")?"network":r.includes("wallet")||r.includes("auth")||r.includes("permission")?"auth":r.includes("storage")||r.includes("localStorage")||r.includes("sessionStorage")?"storage":r.includes("walrus")||r.includes("blob")?"walrus":r.includes("blockchain")||r.includes("sui")||r.includes("transaction")?"blockchain":"unknown"}(o=s||(s={})).NETWORK="network",o.AUTH="auth",o.STORAGE="storage",o.WALRUS="walrus",o.BLOCKCHAIN="blockchain",o.UNKNOWN="unknown";let d={async saveError(e){try{let r="error_log_".concat(e.id);localStorage.setItem(r,JSON.stringify(e));let t=Object.keys(localStorage).filter(e=>e.startsWith("error_log_"));t.length>50&&t.sort().slice(0,t.length-50).forEach(e=>localStorage.removeItem(e))}catch(e){console.warn("Failed to persist error:",e)}},async getErrors(){try{let e=[];for(let r of Object.keys(localStorage).filter(e=>e.startsWith("error_log_")))try{let t=JSON.parse(localStorage.getItem(r)||"{}");e.push(t)}catch(e){localStorage.removeItem(r)}return e.sort((e,r)=>r.timestamp-e.timestamp)}catch(e){return console.warn("Failed to retrieve errors:",e),[]}},async clearErrors(){try{Object.keys(localStorage).filter(e=>e.startsWith("error_log_")).forEach(e=>localStorage.removeItem(e))}catch(e){console.warn("Failed to clear errors:",e)}}};function u(e){let r;r="string"==typeof e?{message:e}:e instanceof Error?{message:e.message,code:e.code}:e,a.default.error(e=>(0,n.jsxs)("div",{className:"flex flex-col",children:[r.title&&(0,n.jsx)("div",{className:"font-semibold text-sm mb-1",children:r.title}),(0,n.jsx)("div",{className:"text-sm",children:r.message}),r.code&&(0,n.jsxs)("div",{className:"text-xs text-red-400 mt-1",children:["Code: ",r.code]}),r.showRetry&&r.onRetry&&(0,n.jsx)("button",{onClick:()=>{var t;a.default.dismiss(e.id),null===(t=r.onRetry)||void 0===t||t.call(r)},className:"mt-2 text-xs bg-red-600 hover:bg-red-700 text-white px-2 py-1 rounded",children:"Retry"})]}),{duration:r.duration||5e3,style:{background:"#FEF2F2",color:"#991B1B",border:"1px solid #FCA5A5"}})}function m(e){let{children:r,fallback:t,onError:o}=e,[s,m]=(0,l.useState)(!1),[g,h]=(0,l.useState)(null),[x,v]=(0,l.useState)(!1),[f,w]=(0,l.useState)(0),[p,y]=(0,l.useState)(!1),b=(0,l.useCallback)(async()=>{p||(y(!0),m(!1),h(null),w(e=>e+1),a.default.success("Attempting recovery...",{duration:2e3,position:"top-right"}),await new Promise(e=>setTimeout(e,1e3)),y(!1))},[p]);(0,l.useEffect)(()=>{v(!0);let e=e=>{var r,t,s,n,l,a,g;if((null===(t=e.error)||void 0===t?void 0:null===(r=t.message)||void 0===r?void 0:r.includes("Access to storage is not allowed"))||(null===(n=e.error)||void 0===n?void 0:null===(s=n.message)||void 0===s?void 0:s.includes("localStorage"))||(null===(a=e.error)||void 0===a?void 0:null===(l=a.message)||void 0===l?void 0:l.includes("sessionStorage"))){e.preventDefault();return}let x=(null===(g=e.error)||void 0===g?void 0:g.message)||"",v=["Error storing todo on blockchain","Failed to create todo","Failed to update todo","Failed to delete todo","404","500","503"].some(e=>x.includes(e)),f=e.error instanceof Error?e.error:Error(String(e.error)),w=c(f);d.saveError({id:"error_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),timestamp:Date.now(),type:w,message:f.message,stack:f.stack,retryCount:0,recovered:!1,recoveryAttempts:[]}).catch(()=>{}),v&&u({title:"Critical Error",message:x||"An unexpected error occurred",duration:5e3,showRetry:!0,onRetry:()=>{b()}}),h(f),m(!0),null==o||o(f);let p=(0,i.IH)();p&&p.trackError(f,{source:"error-boundary",critical:v,url:window.location.href}),e.preventDefault()},r=e=>{let r=String(e.reason);if(r.includes("Access to storage is not allowed")||r.includes("localStorage")||r.includes("sessionStorage")||r.includes("select failed: wallet")||r.includes("UNKNOWN_ERROR")||r.includes("KIT.UNKNOWN_ERROR")||r.includes("is not available")||r.includes("wallet Slush")||r.includes("all wallets are listed here: []")||r.includes("Wallet Standard has already been loaded")){e.preventDefault();return}let t=String(e.reason),s=["Error storing todo on blockchain","Failed to create todo","Failed to update todo","Failed to delete todo","404","500","503"].some(e=>t.includes(e)),n=e.reason instanceof Error?e.reason:Error(String(e.reason)),l=c(n);d.saveError({id:"error_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)),timestamp:Date.now(),type:l,message:n.message,stack:n.stack,retryCount:0,recovered:!1,recoveryAttempts:[]}).catch(()=>{}),s&&u({title:"Critical Error",message:t||"An unexpected error occurred",duration:5e3,showRetry:!0,onRetry:()=>{b()}}),h(n),m(!0),null==o||o(n);let a=(0,i.IH)();a&&a.trackError(n,{source:"unhandled-rejection",critical:s,url:window.location.href}),e.preventDefault()};return window.addEventListener("error",e),window.addEventListener("unhandledrejection",r),()=>{window.removeEventListener("error",e),window.removeEventListener("unhandledrejection",r)}},[o,b]);let N=(0,n.jsxs)("div",{className:"max-w-2xl mx-auto p-6 m-4",children:[(0,n.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:(0,n.jsxs)("div",{className:"flex items-start",children:[(0,n.jsx)("div",{className:"flex-shrink-0",children:(0,n.jsx)("svg",{className:"h-6 w-6 text-red-400",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),(0,n.jsxs)("div",{className:"ml-3 flex-1",children:[(0,n.jsx)("h3",{className:"text-lg font-medium text-red-800",children:"Oops! Something went wrong"}),(0,n.jsxs)("div",{className:"mt-2 text-sm text-red-700",children:[(0,n.jsx)("p",{className:"mb-2",children:(null==g?void 0:g.message)||"An unexpected error occurred while processing your request."}),f>0&&(0,n.jsxs)("p",{className:"text-xs text-red-600 mt-2",children:["Retry attempts: ",f]})]}),!1,(0,n.jsxs)("div",{className:"mt-4 flex space-x-3",children:[(0,n.jsx)("button",{onClick:b,className:"px-4 py-2 bg-red-600 text-white text-sm font-medium rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-colors",children:"Try Again"}),(0,n.jsx)("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-gray-200 text-gray-700 text-sm font-medium rounded-md hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors",children:"Reload Page"})]})]})]})}),(0,n.jsx)("div",{className:"mt-4 text-sm text-gray-500 text-center",children:"If this problem persists, please contact support."})]});return(0,n.jsx)("div",{suppressHydrationWarning:!0,children:s?t||N:r})}}}]);