"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3170],{23170:function(e,t,r){r.d(t,{U:function(){return x}});var a=r(29754),l=r(22585),s=r(41601),i=r(67985),n=r(93143),d=r(2380),o=r(20457),c=r(44066),u=r(26168),h=r(59295),m=r(32608);let x=e=>{let{className:t=""}=e,r=(0,u.t)(),x=(0,h.n)(),g=null==r?void 0:r.address,[v,p]=(0,l.useState)("grid"),[y,j]=(0,l.useState)("date"),[f,b]=(0,l.useState)("all"),[N,w]=(0,l.useState)(""),[k,C]=(0,l.useState)(["high","medium","low"]),[T,S]=(0,l.useState)({start:null,end:null}),I=function(e,t){let[r,a]=(0,l.useState)(e);return(0,l.useEffect)(()=>{let t=setTimeout(()=>{a(e)},300);return()=>{clearTimeout(t)}},[e,300]),r}(N,0),{data:M,error:L,fetchNextPage:D,hasNextPage:A,isFetchingNextPage:_,isLoading:F,isError:P}=(0,s.N)({queryKey:["todoNFTs",g,I,y,f,k,T],queryFn:async e=>{let{pageParam:t}=e;if(!g)return{nfts:[],nextCursor:null};let r=await x.getClient();if(!r)return{nfts:[],nextCursor:null};try{let{data:e,nextCursor:a}=await r.getOwnedObjects({owner:g,filter:{StructType:"".concat(m.env.NEXT_PUBLIC_PACKAGE_ID,"::todo_nft::TodoNFT")},options:{showContent:!0,showType:!0,showOwner:!0,showDisplay:!0},cursor:t,limit:50});return{nfts:e.filter(e=>{var t,r;return(null===(r=e.data)||void 0===r?void 0:null===(t=r.content)||void 0===t?void 0:t.dataType)==="moveObject"}).map(e=>{var t,r,a,l,s,i;let n=null===(t=e.data)||void 0===t?void 0:t.content,d=(null==n?void 0:n.dataType)==="moveObject"?n.fields:{},o={id:(null===(r=e.data)||void 0===r?void 0:r.objectId)||"",title:(null==d?void 0:d.title)||"",description:(null==d?void 0:d.description)||"",completed:(null==d?void 0:d.completed)||!1,priority:(null==d?void 0:d.priority)||"medium",createdAt:new Date((null==d?void 0:d.created_at)||Date.now()).toISOString(),imageUrl:(null==d?void 0:d.image_url)||"",owner:(null==d?void 0:d.owner)||("string"==typeof(null===(a=e.data)||void 0===a?void 0:a.owner)?e.data.owner:null===(s=e.data)||void 0===s?void 0:null===(l=s.owner)||void 0===l?void 0:l.AddressOwner)||"",blockchainStored:!0,objectId:null===(i=e.data)||void 0===i?void 0:i.objectId,metadata:null==d?void 0:d.metadata,isPrivate:(null==d?void 0:d.is_private)||!1};return(0,c.L6)(o)}),nextCursor:a}}catch(e){throw console.error("Error fetching NFTs:",e),e}},getNextPageParam:e=>e.nextCursor,initialPageParam:null,enabled:!!g&&x.isInitialized}),O=(0,l.useMemo)(()=>(null==M?void 0:M.pages.flatMap(e=>e.nfts))||[],[M]),z=(0,l.useMemo)(()=>{let e=[...O];if(I){let t=I.toLowerCase();e=e.filter(e=>e.title.toLowerCase().includes(t)||e.description&&e.description.toLowerCase().includes(t))}return"completed"===f?e=e.filter(e=>e.completed):"active"===f&&(e=e.filter(e=>!e.completed)),e=e.filter(e=>k.includes(e.priority)),(T.start||T.end)&&(e=e.filter(e=>{let t=new Date(e.createdAt||Date.now());return(!T.start||!(t<T.start))&&(!T.end||!(t>T.end))})),e.sort((e,t)=>{switch(y){case"date":return new Date(t.createdAt||0).getTime()-new Date(e.createdAt||0).getTime();case"title":return e.title.localeCompare(t.title);case"priority":let r={high:0,medium:1,low:2};return r[e.priority]-r[t.priority];default:return 0}}),e},[O,I,f,k,T,y]),E=(0,l.useCallback)(async(e,t)=>{A&&!_&&await D()},[D,A,_]),H=(0,l.useCallback)(e=>e<z.length,[z.length]),B=(0,l.useCallback)(e=>{let{columnIndex:t,rowIndex:r,style:l}=e,s=r*Math.floor((l.width-16)/336)+t;if(s>=z.length)return null;let i=z[s];return i?(0,a.jsx)("div",{style:{...l,left:l.left+16,top:l.top+16,width:320,height:400},children:(0,a.jsx)(o.x,{todo:i})}):null},[z]),W=(0,l.useCallback)(e=>{let{index:t,style:r}=e;if(!H(t))return(0,a.jsx)("div",{style:r,className:"flex items-center justify-center",children:(0,a.jsx)("div",{className:"animate-pulse bg-gray-200 dark:bg-gray-700 rounded-lg w-full h-24"})});let l=z[t];return l?(0,a.jsx)("div",{style:r,className:"px-4",children:(0,a.jsx)(o.x,{todo:l,variant:"list"})}):null},[z,H]);return F?(0,a.jsx)("div",{className:"".concat(t," p-4"),children:(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:Array.from({length:8}).map((e,t)=>(0,a.jsx)("div",{className:"animate-pulse",children:(0,a.jsx)("div",{className:"bg-gray-200 dark:bg-gray-700 rounded-lg h-96"})},t))})}):P?(0,a.jsx)("div",{className:"".concat(t," flex items-center justify-center h-64"),children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("p",{className:"text-red-500 mb-2",children:"Error loading NFTs"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:null==L?void 0:L.message})]})}):0===z.length?(0,a.jsx)("div",{className:"".concat(t," flex items-center justify-center h-64"),children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})}),(0,a.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900 dark:text-gray-100",children:"No NFTs found"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:N?"Try adjusting your search or filters":"Get started by creating your first Todo NFT"})]})}):(0,a.jsxs)("div",{className:"".concat(t," flex flex-col h-full"),children:[(0,a.jsx)("div",{className:"flex-shrink-0 p-4 bg-white dark:bg-gray-800 border-b dark:border-gray-700",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)("input",{type:"text",placeholder:"Search NFTs...",value:N,onChange:e=>w(e.target.value),className:"w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600"})}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:()=>p("grid"),className:"p-2 rounded ".concat("grid"===v?"bg-blue-500 text-white":"bg-gray-200 dark:bg-gray-700"),"aria-label":"Grid view",children:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})}),(0,a.jsx)("button",{onClick:()=>p("list"),className:"p-2 rounded ".concat("list"===v?"bg-blue-500 text-white":"bg-gray-200 dark:bg-gray-700"),"aria-label":"List view",children:(0,a.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})]})]}),(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mr-2",children:"Sort by:"}),(0,a.jsxs)("select",{value:y,onChange:e=>j(e.target.value),className:"px-3 py-1 border rounded-md dark:bg-gray-700 dark:border-gray-600",children:[(0,a.jsx)("option",{value:"date",children:"Date"}),(0,a.jsx)("option",{value:"title",children:"Title"}),(0,a.jsx)("option",{value:"priority",children:"Priority"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mr-2",children:"Show:"}),(0,a.jsxs)("select",{value:f,onChange:e=>b(e.target.value),className:"px-3 py-1 border rounded-md dark:bg-gray-700 dark:border-gray-600",children:[(0,a.jsx)("option",{value:"all",children:"All"}),(0,a.jsx)("option",{value:"active",children:"Active"}),(0,a.jsx)("option",{value:"completed",children:"Completed"})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Priority:"}),["high","medium","low"].map(e=>(0,a.jsxs)("label",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",checked:k.includes(e),onChange:t=>{t.target.checked?C([...k,e]):C(k.filter(t=>t!==e))},className:"mr-1"}),(0,a.jsx)("span",{className:"text-sm capitalize",children:e})]},e))]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Date:"}),(0,a.jsx)("input",{type:"date",value:T.start?T.start.toISOString().split("T")[0]:"",onChange:e=>S({...T,start:e.target.value?new Date(e.target.value):null}),className:"px-2 py-1 border rounded-md text-sm dark:bg-gray-700 dark:border-gray-600"}),(0,a.jsx)("span",{className:"text-sm",children:"to"}),(0,a.jsx)("input",{type:"date",value:T.end?T.end.toISOString().split("T")[0]:"",onChange:e=>S({...T,end:e.target.value?new Date(e.target.value):null}),className:"px-2 py-1 border rounded-md text-sm dark:bg-gray-700 dark:border-gray-600"})]})]}),(0,a.jsxs)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Showing ",z.length," of ",O.length," NFTs"]})]})}),(0,a.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,a.jsx)(d.ZP,{children:e=>{let{height:t,width:r}=e;return(0,a.jsx)(n.Z,{isItemLoaded:H,itemCount:z.length+(A?1:0),loadMoreItems:E,children:e=>{let{onItemsRendered:l,ref:s}=e;if("grid"!==v)return(0,a.jsx)(i.t7,{ref:s,height:t,itemCount:z.length,itemSize:120,width:r,onItemsRendered:l,children:W});{let e=Math.floor((r-16)/336),n=Math.ceil(z.length/e);return(0,a.jsx)(i.Ym,{ref:s,columnCount:e,columnWidth:336,height:t,rowCount:n,rowHeight:416,width:r,onItemsRendered:t=>{let{visibleRowStartIndex:r,visibleRowStopIndex:a,visibleColumnStartIndex:s,visibleColumnStopIndex:i}=t,n=r*e+s,d=a*e+i;l({visibleStartIndex:n,visibleStopIndex:d,overscanStartIndex:n,overscanStopIndex:d})},children:B})}}})}})}),_&&(0,a.jsx)("div",{className:"flex-shrink-0 p-4 text-center border-t dark:border-gray-700",children:(0,a.jsx)("span",{className:"text-sm text-gray-500",children:"Loading more NFTs..."})})]})}}}]);