"use strict";exports.id=467,exports.ids=[467],exports.modules={43467:(e,t,r)=>{r.d(t,{tN:()=>s}),r(87009);var n=r(926),a=r.n(n);r(30242),r(11470),r(3123);let o=(0,n.createContext)(null),i=()=>({connected:!1,connecting:!1,account:null,address:null,chainId:null,name:null,network:"testnet",connect:()=>{"undefined"!=typeof console&&console.warn&&console.warn("[WalletContext] Connect called before initialization")},disconnect:()=>Promise.resolve(),signAndExecuteTransaction:()=>Promise.reject(Error("Wallet not initialized")),trackTransaction:()=>Promise.reject(Error("Wallet not initialized")),sessionExpired:!1,resetSession:()=>{},lastActivity:0,resetActivityTimer:()=>{},transactionHistory:[],transactions:[],addTransaction:()=>{},currentNetwork:"testnet",switchNetwork:()=>{},error:null,clearError:()=>{},setError:()=>{},isModalOpen:!1,openModal:()=>{},closeModal:()=>{}}),s=()=>(0,n.useContext)(o)||i();a().Component},65054:(e,t,r)=>{r.d(t,{P3:()=>i,qn:()=>l}),r(926);let n=null,a=null,o={testnet:{network:{name:"testnet",url:"https://fullnode.testnet.sui.io:443",faucetUrl:"https://faucet.testnet.sui.io",explorerUrl:"https://testnet.suiexplorer.com"},walrus:{networkUrl:"https://wal.testnet.sui.io",publisherUrl:"https://publisher-testnet.walrus.space",aggregatorUrl:"https://aggregator-testnet.walrus.space",apiPrefix:"https://api-testnet.walrus.tech/1.0"},deployment:{packageId:"0x0",digest:"unknown",timestamp:new Date().toISOString(),deployerAddress:"0x0"},contracts:{todoNft:{packageId:"0x0",moduleName:"todo_nft",structName:"TodoNFT"}},features:{aiEnabled:!0,blockchainVerification:!1,encryptedStorage:!1}},devnet:{network:{name:"devnet",url:"https://fullnode.devnet.sui.io:443",faucetUrl:"https://faucet.devnet.sui.io",explorerUrl:"https://devnet.suiexplorer.com"},walrus:{networkUrl:"https://wal.devnet.sui.io",publisherUrl:"https://publisher-devnet.walrus.space",aggregatorUrl:"https://aggregator-devnet.walrus.space",apiPrefix:"https://api-devnet.walrus.tech/1.0"},deployment:{packageId:"0x0",digest:"unknown",timestamp:new Date().toISOString(),deployerAddress:"0x0"},contracts:{todoNft:{packageId:"0x0",moduleName:"todo_nft",structName:"TodoNFT"}},features:{aiEnabled:!0,blockchainVerification:!1,encryptedStorage:!1}},localnet:{network:{name:"localnet",url:"http://localhost:9000",explorerUrl:"http://localhost:9001"},walrus:{networkUrl:"http://localhost:31415",publisherUrl:"http://localhost:31416",aggregatorUrl:"http://localhost:31417",apiPrefix:"http://localhost:31418/1.0"},deployment:{packageId:"0x0",digest:"unknown",timestamp:new Date().toISOString(),deployerAddress:"0x0"},contracts:{todoNft:{packageId:"0x0",moduleName:"todo_nft",structName:"TodoNFT"}},features:{aiEnabled:!0,blockchainVerification:!1,encryptedStorage:!1}}};async function i(e){try{let r=await fetch(`/config/${e}.json`);if(r.ok){var t;return{network:{name:(t=await r.json()).network||"testnet",url:t.rpcUrl||t.environment?.apiEndpoint||"https://fullnode.testnet.sui.io:443",faucetUrl:t.faucetUrl,explorerUrl:t.explorerUrl||"https://testnet.suiexplorer.com"},walrus:{networkUrl:t.walrus?.networkUrl||"https://wal.testnet.sui.io",publisherUrl:t.walrus?.publisherUrl||"https://publisher-testnet.walrus.space",aggregatorUrl:t.walrus?.aggregatorUrl||"https://aggregator-testnet.walrus.space",apiPrefix:t.walrus?.apiPrefix||"https://api-testnet.walrus.tech/1.0"},deployment:{packageId:t.deployment?.packageId||"0x0",digest:t.deployment?.transactionHash||"unknown",timestamp:t.deployment?.timestamp||new Date().toISOString(),deployerAddress:t.deployment?.deployerAddress||"0x0"},contracts:{todoNft:{packageId:t.deployment?.packageId||"0x0",moduleName:"todo_nft",structName:"TodoNFT"}},features:{aiEnabled:t.features?.aiIntegration||!1,blockchainVerification:t.features?.blockchainVerification||!1,encryptedStorage:t.features?.encryptedStorage||!1}}}}catch(t){console.warn(`Failed to load runtime config for ${e}:`,t)}return null}async function s(e){return i(e)}async function l(){let e=process.env.NEXT_PUBLIC_NETWORK||"testnet";if(n&&a===e)return n;let t=await s(e);return t||(t=function(e){let t=o[e];if(!t)throw Error(`No configuration available for network: ${e}`);return console.warn(`Using fallback configuration for ${e} - run 'waltodo deploy' to generate proper config`),t}(e)),t.deployment.packageId&&"0x0"!==t.deployment.packageId||console.warn("Package ID not set - some blockchain features may not work"),n=t,a=e,t}},11470:(e,t,r)=>{r.d(t,{completeTodoOnBlockchain:()=>_,deleteTodoOnBlockchain:()=>C,$6:()=>v,tx:()=>E,xe:()=>$,sP:()=>b,Yb:()=>U,ZR:()=>x,storeTodoOnBlockchain:()=>S,updateTodoOnBlockchain:()=>A,wi:()=>N});var n=r(59821),a=r(31261),o=r(75912),i=r(65054);let s={aggregatorUrl:"https://walrus-testnet-aggregator.nodes.guru",publisherUrl:"https://walrus-testnet-publisher.nodes.guru",cacheTimeoutMs:3e5},l=new Map;function c(e,t={}){let r={...s,...t},n=`${e}:${r.aggregatorUrl}`,a=l.get(n);if(a&&Date.now()-a.timestamp<r.cacheTimeoutMs)return a.url;let o=e.trim().replace(/^0x/,""),i=`${r.aggregatorUrl}/v1/${o}`;return l.set(n,{url:i,timestamp:Date.now()}),i}let u={PACKAGE_ID:"0xe8d420d723b6813d1e001d8cba0dfc8613cbc814dedb4adcd41909f2e11daa8b",MODULE_NAME:"todo_nft",STRUCT_NAME:"TodoNFT"},d=new Map;class p extends Error{constructor(e,t){super(e),this.code=t,this.name="SuiClientError"}}class g extends p{constructor(){super("Wallet not connected","WALLET_NOT_CONNECTED"),this.name="WalletNotConnectedError"}}let f=null,w="testnet",m=null,h=null,y=!1,k=0;async function T(){return h||(f&&y?f:h=(async()=>{try{return w=(m=await (0,i.qn)()).network.name,f=new n.u({url:m.network.url}),y=!0,k=0,f}catch(e){throw setTimeout(()=>{h=null},1e3),e}})())}async function b(e="testnet"){if(h)return h;if(f&&y&&w===e)return f;try{return await T()}catch(t){return h=(async()=>{try{return w=e,f=new n.u({url:{mainnet:"https://fullnode.mainnet.sui.io:443",testnet:"https://fullnode.testnet.sui.io:443",devnet:"https://fullnode.devnet.sui.io:443",localnet:"http://127.0.0.1:9000"}[e]}),y=!0,k=0,f}catch(e){throw setTimeout(()=>{h=null},1e3),e}})()}}async function E(){if(f&&y)return f;if(h)try{return await h}catch(e){throw e}if(k>=3)throw new p("Sui client initialization failed after 3 attempts","INITIALIZATION_FAILED");k++;try{return await I()}catch(e){if(k>=3)throw new p(`Failed to initialize Sui client after 3 attempts: ${e instanceof Error?e.message:"Unknown error"}`,"INITIALIZATION_FAILED");throw e}}function U(){return y&&null!==f}async function I(e="testnet"){return U()?f:h||b(e)}function x(){f=null,y=!1,h=null,k=0,m=null}async function N(e,t=2){let r;for(let n=0;n<t;n++)try{let t=await E();return await e(t)}catch(e){if(r=e instanceof Error?e:Error(String(e)),n<t-1&&(r.message.includes("not initialized")||r.message.includes("initialization failed"))){x(),await new Promise(e=>setTimeout(e,1e3));continue}if(n===t-1)break}throw r}function v(){return m?.deployment.packageId?m.deployment.packageId:u.PACKAGE_ID}async function $(e,t){let r=t?.maxRetries??3,n=null;for(let a=0;a<r;a++)try{if(!e)throw new g;return await N(async r=>{let n=(await r.getOwnedObjects({owner:e,filter:{StructType:`${v()}::${u.MODULE_NAME}::${u.STRUCT_NAME}`},options:{showContent:!0,showOwner:!0,showType:!0}})).data.map(e=>(function(e,t){if(!e.data?.content||"moveObject"!==e.data.content.dataType)return null;let r=e.data.objectId;if(t?.useCache){let e=d.get(r);if(e&&Date.now()-e.timestamp<3e5)return e.todo}let n=e.data.content.fields;if(!n)return null;try{let e;let a=function(e){try{if(!e||""===e)return{};return JSON.parse(e)}catch(e){return console.warn("Failed to parse metadata:",e),{}}}(n.metadata||""),o=n.image_url;if(o&&(o.startsWith("http")||(o=c(o)),t?.generateThumbnails)){let t=function(e){try{let t=new URL(e).pathname.split("/"),r=t.indexOf("v1");if(-1!==r&&t.length>r+1)return t[r+1];let n=e.match(/[a-fA-F0-9]{64,}/);return n?n[0]:null}catch{return null}}(o)||n.image_url;t&&(e=function(e,t={}){let r=c(e,t);return{original:r,large:`${r}?size=large`,medium:`${r}?size=medium`,small:`${r}?size=small`,thumbnail:`${r}?size=thumbnail`}}(t))}let i=a.labels||[],s="medium";i.includes("urgent")||i.includes("high-priority")?s="high":i.includes("low-priority")&&(s="low");let l={id:r,objectId:r,title:n.title||"Untitled",description:n.description||"",completed:!0===n.completed,priority:s,tags:i,blockchainStored:!0,imageUrl:o,createdAt:n.created_at?new Date(parseInt(n.created_at)).toISOString():new Date().toISOString(),completedAt:n.completed_at?new Date(parseInt(n.completed_at)).toISOString():void 0,owner:n.owner,metadata:n.metadata||"",isPrivate:!0===n.is_private};return t?.useCache&&d.set(r,{todo:l,timestamp:Date.now(),thumbnails:e}),l}catch(e){return console.error("Error transforming Sui object to Todo:",e),null}})(e,{useCache:t?.useCache,generateThumbnails:t?.generateThumbnails})).filter(e=>null!==e);return t?.filter?function(e,t){return e.filter(e=>{if(void 0!==t.completed&&e.completed!==t.completed||void 0!==t.isPrivate&&e.isPrivate!==t.isPrivate)return!1;if(t.tags&&t.tags.length>0){let r=e.tags||[];if(!t.tags.some(e=>r.includes(e)))return!1}if(t.dateRange&&e.createdAt){let r=new Date(e.createdAt);if(r<t.dateRange.start||r>t.dateRange.end)return!1}if(t.searchTerm){let r=t.searchTerm.toLowerCase(),n=e.title.toLowerCase().includes(r),a=e.description?.toLowerCase().includes(r),o=e.tags?.some(e=>e.toLowerCase().includes(r));if(!n&&!a&&!o)return!1}return!0})}(n,t.filter):n})}catch(e){n=e instanceof Error?e:Error(String(e)),console.warn(`Attempt ${a+1}/${r} failed:`,n.message),a<r-1&&await new Promise(e=>setTimeout(e,1e3*Math.pow(2,a)))}if(n instanceof p)throw n;throw new p(`Failed to fetch todos after ${r} attempts: ${n?.message||"Unknown error"}`)}async function S(e,t,r){try{if(!r)throw new g;let n=function(e,t){let r=new a.Y;return r.setSender(t),r.moveCall({target:`${v()}::${u.MODULE_NAME}::create_todo`,arguments:[r.pure(o.$5.string().serialize(e.title)),r.pure(o.$5.string().serialize(e.description)),r.pure(o.$5.string().serialize(e.imageUrl||"")),r.pure(o.$5.string().serialize(e.metadata||"")),r.pure(o.$5.bool().serialize(e.isPrivate||!1))]}),r}(e,r),i=await t(n);if(i.digest){let e=await N(async e=>{let t=await e.getTransactionBlock({digest:i.digest,options:{showEffects:!0,showObjectChanges:!0}}),r=t.objectChanges?.find(e=>"created"===e.type&&e.objectType?.includes(u.STRUCT_NAME));return r?.objectId});return{success:!0,digest:i.digest,objectId:e}}return{success:!1,error:"Transaction failed without digest"}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async function A(e,t,r){try{if(!r)throw new g;let n=function(e,t){let r=new a.Y;return r.setSender(t),r.moveCall({target:`${v()}::${u.MODULE_NAME}::update_todo`,arguments:[r.object(e.objectId),r.pure(o.$5.string().serialize(e.title||"")),r.pure(o.$5.string().serialize(e.description||"")),r.pure(o.$5.string().serialize(e.imageUrl||"")),r.pure(o.$5.string().serialize(e.metadata||""))]}),r}(e,r),i=await t(n);return{success:!!i.digest,digest:i.digest,error:i.digest?void 0:"Transaction failed"}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async function _(e,t,r){try{if(!r)throw new g;let n=function(e,t){let r=new a.Y;return r.setSender(t),r.moveCall({target:`${v()}::${u.MODULE_NAME}::complete_todo`,arguments:[r.object(e)]}),r}(e,r),o=await t(n);return{success:!!o.digest,digest:o.digest,error:o.digest?void 0:"Transaction failed"}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}async function C(e,t,r){try{if(!r)throw new g;let n=function(e,t){let r=new a.Y;return r.setSender(t),r.moveCall({target:`${v()}::${u.MODULE_NAME}::delete_todo`,arguments:[r.object(e)]}),r}(e,r),o=await t(n);return{success:!!o.digest,digest:o.digest,error:o.digest?void 0:"Transaction failed"}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}}};